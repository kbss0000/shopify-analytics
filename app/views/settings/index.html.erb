<% content_for :page_title, "Settings" %>
<% content_for :page_subtitle, "Manage your preferences and account." %>

<div class="max-w-4xl mx-auto space-y-8 animate-fade-in">
  
  <!-- Preferences -->
  <div class="bg-[#151516] backdrop-blur-md border border-[#2E3035] rounded-2xl p-8 shadow-lg">
    <h3 class="text-lg font-bold text-[#EEEFF1] mb-6 flex items-center">
      <svg class="w-5 h-5 mr-2 text-[#5E6AD2]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
      </svg>
      Appearance & Localization
    </h3>
    
    <div class="space-y-6">
      <!-- Currency Toggle -->
      <div class="flex items-center justify-between p-5 bg-[#1A1B1E] rounded-xl border border-[#2E3035] shadow-sm hover:shadow-md transition-all duration-200">
        <div class="flex-1">
          <h4 class="text-sm font-semibold text-[#EEEFF1] mb-1">Display Currency</h4>
          <p class="text-xs text-[#8A8F98]">Choose your preferred currency for reports.</p>
        </div>
        <div class="flex items-center space-x-2 bg-[#0F0F10] p-1.5 rounded-lg border border-[#2E3035] shadow-inner">
          <%= button_to "USD", "/settings/currency", 
              method: :post,
              params: { currency: "USD" },
              class: "px-4 py-2 text-xs font-semibold rounded-md transition-all duration-200 #{session[:currency] != 'INR' ? 'bg-[#5E6AD2] text-white transform scale-105' : 'text-[#8A8F98] hover:text-[#EEEFF1] hover:bg-[#1A1B1E]'}" %>
          <%= button_to "INR", "/settings/currency", 
              method: :post,
              params: { currency: "INR" },
              class: "px-4 py-2 text-xs font-semibold rounded-md transition-all duration-200 #{session[:currency] == 'INR' ? 'bg-[#5E6AD2] text-white transform scale-105' : 'text-[#8A8F98] hover:text-[#EEEFF1] hover:bg-[#1A1B1E]'}" %>
        </div>
      </div>
    </div>
  </div>

  <!-- Account Settings -->
  <div class="bg-[#151516] backdrop-blur-md border border-[#2E3035] rounded-2xl p-8 shadow-lg">
    <h3 class="text-lg font-bold text-[#EEEFF1] mb-6 flex items-center">
      <svg class="w-5 h-5 mr-2 text-[#5E6AD2]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
      </svg>
      Account Settings
    </h3>
    
    <%= form_with model: current_tenant, url: settings_account_path, method: :patch, local: true, class: "space-y-6" do |f| %>
      <!-- Name Field -->
      <div>
        <label for="tenant_name" class="block text-sm font-semibold text-[#EEEFF1] mb-2">Store Name</label>
        <%= f.text_field :name, 
            class: "w-full px-4 py-2.5 bg-[#0F0F10] border border-[#2E3035] rounded-lg text-[#EEEFF1] placeholder-[#8A8F98] focus:outline-none focus:ring-2 focus:ring-[#5E6AD2] focus:border-transparent transition-all duration-200",
            placeholder: "Enter your store name" %>
        <p class="text-xs text-[#8A8F98] mt-1">This is the name displayed in your dashboard.</p>
      </div>

      <!-- Email Field -->
      <div>
        <label for="tenant_email" class="block text-sm font-semibold text-[#EEEFF1] mb-2">Email Address</label>
        <%= f.email_field :email, 
            class: "w-full px-4 py-2.5 bg-[#0F0F10] border border-[#2E3035] rounded-lg text-[#EEEFF1] placeholder-[#8A8F98] focus:outline-none focus:ring-2 focus:ring-[#5E6AD2] focus:border-transparent transition-all duration-200",
            placeholder: "your@email.com" %>
        <p class="text-xs text-[#8A8F98] mt-1">Used for login and notifications.</p>
      </div>

      <!-- Password Section -->
      <div class="pt-4 border-t border-[#2E3035]">
        <h4 class="text-sm font-semibold text-[#EEEFF1] mb-4">Change Password</h4>
        <p class="text-xs text-[#8A8F98] mb-4">Leave blank if you don't want to change your password.</p>
        
        <div class="space-y-4">
          <!-- Current Password -->
          <div>
            <label for="tenant_current_password" class="block text-sm font-medium text-[#EEEFF1] mb-2">Current Password</label>
            <%= f.password_field :current_password, 
                class: "w-full px-4 py-2.5 bg-[#0F0F10] border border-[#2E3035] rounded-lg text-[#EEEFF1] placeholder-[#8A8F98] focus:outline-none focus:ring-2 focus:ring-[#5E6AD2] focus:border-transparent transition-all duration-200",
                placeholder: "Enter current password",
                autocomplete: "current-password" %>
          </div>

          <!-- New Password -->
          <div>
            <label for="tenant_password" class="block text-sm font-medium text-[#EEEFF1] mb-2">New Password</label>
            <%= f.password_field :password, 
                class: "w-full px-4 py-2.5 bg-[#0F0F10] border border-[#2E3035] rounded-lg text-[#EEEFF1] placeholder-[#8A8F98] focus:outline-none focus:ring-2 focus:ring-[#5E6AD2] focus:border-transparent transition-all duration-200",
                placeholder: "Enter new password (min 6 characters)",
                autocomplete: "new-password" %>
          </div>

          <!-- Password Confirmation -->
          <div>
            <label for="tenant_password_confirmation" class="block text-sm font-medium text-[#EEEFF1] mb-2">Confirm New Password</label>
            <%= f.password_field :password_confirmation, 
                class: "w-full px-4 py-2.5 bg-[#0F0F10] border border-[#2E3035] rounded-lg text-[#EEEFF1] placeholder-[#8A8F98] focus:outline-none focus:ring-2 focus:ring-[#5E6AD2] focus:border-transparent transition-all duration-200",
                placeholder: "Confirm new password",
                autocomplete: "new-password" %>
          </div>
        </div>
      </div>

      <!-- Submit Button -->
      <div class="flex justify-end pt-4 border-t border-[#2E3035]">
        <%= f.submit "Save Changes", 
            class: "px-6 py-2.5 bg-[#5E6AD2] text-white font-semibold rounded-lg hover:bg-[#5E6AD2]/90 transition-all duration-200 transform hover:scale-105 active:scale-95 cursor-pointer" %>
      </div>
    <% end %>

    <!-- Account Info Section -->
    <div class="mt-8 pt-6 border-t border-[#2E3035]">
      <h4 class="text-sm font-semibold text-[#EEEFF1] mb-4">Account Information</h4>
      <div class="space-y-3">
        <div class="flex justify-between items-center p-3 bg-[#1A1B1E] rounded-lg border border-[#2E3035]">
          <span class="text-sm text-[#8A8F98]">Account Created</span>
          <span class="text-sm font-medium text-[#EEEFF1]"><%= current_tenant.created_at.strftime("%B %d, %Y") %></span>
        </div>
        <div class="flex justify-between items-center p-3 bg-[#1A1B1E] rounded-lg border border-[#2E3035]">
          <span class="text-sm text-[#8A8F98]">Last Sign In</span>
          <span class="text-sm font-medium text-[#EEEFF1]">
            <%= current_tenant.last_sign_in_at ? current_tenant.last_sign_in_at.strftime("%B %d, %Y at %I:%M %p") : "Never" %>
          </span>
        </div>
        <% if current_tenant.shopify_connected? %>
          <div class="flex justify-between items-center p-3 bg-[#1A1B1E] rounded-lg border border-[#2E3035]">
            <span class="text-sm text-[#8A8F98]">Shopify Store</span>
            <span class="text-sm font-medium text-[#EEEFF1]"><%= current_tenant.shopify_domain %></span>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>